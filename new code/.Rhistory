count(ServeDepth)
subset_m <- subset_m %>%
filter(ServeDepth != "", ServeWidth != "")
unique_servedepth <- unique(c(subset_m$ServeDepth))
unique_servewidth <- unique(c(subset_m$ServeWidth))
subset_f <- subset_f %>%
filter(ServeDepth != "", ServeWidth != "")
unique_servedepth <- unique(c(subset_f$ServeDepth))
unique_servewidth <- unique(c(subset_f$ServeWidth))
subset_f %>%
count(ServeDepth)
## logistic regression for serving_player_won vs. p_server_beats_returner
logit_model_m <- glm(serving_player_won ~ p_server_beats_returner + 0,
data = subset_m, family = "binomial")
summary(logit_model_m) ## not significant
# new models with just second serves
subset_m_second <- subset_m[ServeNumber == 2]
subset_f_second <- subset_f[ServeNumber == 2]
## logistic regression for serving_player_won vs. p_server_beats_returner
logit_model_m <- glm(serving_player_won ~ p_server_beats_returner,
data = subset_m_second, family = "binomial")
summary(logit_model_m) ## p_server_beats_returner significant *** (pos coef)
logit_model_f <- glm(serving_player_won ~ p_server_beats_returner,
data = subset_f_second, family = "binomial")
summary(logit_model_f) ## not significant
logit_model_2_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds,
data = subset_m_second, family = "binomial")
summary(logit_model_2_m) ## p_server_beats_returner significant *** (pos coef), ElapsedSeconds not significant
logit_model_2_f <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds,
data = subset_f_second, family = "binomial")
summary(logit_model_2_f) ## neither significant
## add second serve speed ratio
logit_model_3_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds + speed_ratio,
data = subset_m_second, family = "binomial")
summary(logit_model_3_m) ## p_server_beats_returner significant *** (pos coef), ElapsedSeconds not significant, speed_ratio not significant
logit_model_3_f <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds + speed_ratio,
data = subset_f_second, family = "binomial")
summary(logit_model_3_f) ## nothing significant
## add score importance
logit_model_4_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds + speed_ratio + importance,
data = subset_m_second, family = "binomial")
summary(logit_model_4_m) ## p_server_beats_returner significant *** (pos coef), nothing else significant. but intercept is significant *** (neg coef)
logit_model_4_f <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds + speed_ratio + importance,
data = subset_f_second, family = "binomial")
summary(logit_model_4_f) ## nothing significant
## add location of serve
logit_model_5_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds + importance + speed_ratio + factor(ServeWidth) + factor(ServeDepth),
data = subset_m_second, family = "binomial")
summary(logit_model_5_m) ## p_server_beats_returner significant *** (pos coef), each factor in ServeWidth significant (**, ***) (neg coefs) but not ServeDepth
logit_model_5_f <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds + importance + speed_ratio + factor(ServeWidth) + factor(ServeDepth),
data = subset_f_second, family = "binomial")
summary(logit_model_5_f) ## nothing significant
## add location of serve
logit_model_5_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds + importance + speed_ratio + factor(ServeWidth) + factor(ServeDepth),
data = subset_m_second, family = "binomial")
summary(logit_model_5_m) ## p_server_beats_returner significant *** (pos coef), nothing else significant
logit_model_5_f <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds + importance + speed_ratio + factor(ServeWidth) + factor(ServeDepth),
data = subset_f_second, family = "binomial")
summary(logit_model_5_f) ## nothing significant
## add location of serve
logit_model_5_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds + importance + speed_ratio + factor(ServeWidth) + factor(ServeDepth) + 0,
data = subset_m_second, family = "binomial")
summary(logit_model_5_m) ## p_server_beats_returner significant *** (pos coef), nothing else significant
logit_model_5_f <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds + importance + speed_ratio + factor(ServeWidth) + factor(ServeDepth) + 0,
data = subset_f_second, family = "binomial")
summary(logit_model_5_f) ## nothing significant
## add location of serve
logit_model_5_m <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds + importance + speed_ratio + factor(ServeWidth) + factor(ServeDepth),
data = subset_m_second, family = "binomial")
summary(logit_model_5_m) ## p_server_beats_returner significant *** (pos coef), nothing else significant
logit_model_5_f <- glm(serving_player_won ~ p_server_beats_returner + ElapsedSeconds + importance + speed_ratio + factor(ServeWidth) + factor(ServeDepth),
data = subset_f_second, family = "binomial")
summary(logit_model_5_f) ## nothing significant
rm(list=ls())
# install.packages("welo")
library(welo)
library(tidyverse)
library(data.table)
library(ggplot2)
## wimbledon 2021
subset_m <- as.data.table(read.csv("../data/wimbledon_subset_m.csv"))
subset_f <- as.data.table(read.csv("../data/wimbledon_subset_f.csv"))
View(subset_m)
names(subset_m)
library(ggcorrplot)
subset_m <- subset_m %>%
filter(ServeDepth != "", ServeWidth != "")
subset_f <- subset_f %>%
filter(ServeDepth != "", ServeWidth != "")
subset_m_second <- subset_m[ServeNumber == 2]
subset_f_second <- subset_f[ServeNumber == 2]
## EDA male
numerical_x_cols <- c("p_server_beats_returner", "ElapsedSeconds", "importance", "speed_ratio")
subset_m_x <- subset_m_second %>% select(all_of(numerical_x_cols))
View(subset_m_x)
cor_matrix <- cor(subset_m_x, use = "complete.obs", method = "pearson")
ggcorrplot(cor_matrix,
method = "circle",
type = "lower",
lab = TRUE,
lab_size = 3,
colors = c("blue", "white", "red"),
title = "Correlation Matrix",
ggtheme = theme_minimal())
library(reshape2)
cor_melt <- melt(cor_matrix)
# Simple heatmap using ggplot2
ggplot(cor_melt, aes(x = Var1, y = Var2, fill = value)) +
geom_tile(color = "white") +
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), name = "Pearson\nCorrelation") +
labs(x = "", y = "", title = "Correlation Heatmap") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))
View(cor_melt)
install.packages("fastDummies")
# include categorical variables
subset_m_dummies <- subset_m_second %>%
mutate(across(c(ServeWidth, ServeDepth), as.factor)) %>%
fastDummies::dummy_cols(select_columns = c("ServeWidth", "ServeDepth"), remove_first_dummy = TRUE, remove_selected_columns = TRUE)
subset_m_all <- subset_m_dummies %>%
select(all_of(numerical_x_cols), starts_with("ServeWidth_"), starts_with("ServeDepth_"))
View(subset_m_dummies)
View(subset_m_all)
cor_matrix <- cor(subset_m_all, use = "complete.obs", method = "pearson")
cor_melt <- melt(cor_matrix)
ggplot(cor_melt, aes(x = Var1, y = Var2, fill = value)) +
geom_tile(color = "white") +
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1, 1), name = "Correlation") +
labs(x = "", y = "", title = "Correlation Matrix (Numeric + Dummies)") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(cor_melt, aes(x = Var1, y = Var2, fill = value)) +
geom_tile(color = "white") +
geom_text(aes(label = round(value, 2)), size = 3) +  # Add correlation values
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1, 1), name = "Correlation") +
labs(x = "", y = "", title = "Correlation Matrix with Coefficients") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
## corr matrix female
numerical_x_cols <- c("p_server_beats_returner", "ElapsedSeconds", "importance", "speed_ratio")
subset_f_x <- subset_f_second %>% select(all_of(numerical_x_cols))
cor_matrix <- cor(subset_f_x, use = "complete.obs", method = "pearson")
cor_melt <- melt(cor_matrix)
ggplot(cor_melt, aes(x = Var1, y = Var2, fill = value)) +
geom_tile(color = "white") +
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), name = "Pearson\nCorrelation") +
labs(x = "", y = "", title = "Correlation Heatmap") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))
ggplot(cor_melt, aes(x = Var1, y = Var2, fill = value)) +
geom_tile(color = "white") +
geom_text(aes(label = round(value, 2)), size = 3) +  # Add correlation values
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1, 1), name = "Correlation") +
labs(x = "", y = "", title = "Correlation Matrix with Coefficients") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(cor_melt, aes(x = Var1, y = Var2, fill = value)) +
geom_tile(color = "white") +
geom_text(aes(label = round(value, 2)), size = 3) +  # Add correlation values
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1, 1), name = "Correlation") +
labs(x = "", y = "", title = "Correlation Matrix with Coefficients") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# include categorical variables
subset_f_dummies <- subset_f_second %>%
mutate(across(c(ServeWidth, ServeDepth), as.factor)) %>%
fastDummies::dummy_cols(select_columns = c("ServeWidth", "ServeDepth"), remove_first_dummy = TRUE, remove_selected_columns = TRUE)
subset_f_all <- subset_f_dummies %>%
select(all_of(numerical_x_cols), starts_with("ServeWidth_"), starts_with("ServeDepth_"))
cor_matrix <- cor(subset_f_all, use = "complete.obs", method = "pearson")
cor_melt <- melt(cor_matrix)
ggplot(cor_melt, aes(x = Var1, y = Var2, fill = value)) +
geom_tile(color = "white") +
geom_text(aes(label = round(value, 2)), size = 3) +  # Add correlation values
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1, 1), name = "Correlation") +
labs(x = "", y = "", title = "Correlation Matrix with Coefficients") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
mean_speeds <- subset_m %>%
group_by(ServeNumber) %>%
summarise(mean_speed = mean(Speed_MPH, na.rm = TRUE))
mean_speeds <- subset_m %>%
group_by(ServeNumber) %>%
summarise(mean_speed = mean(Speed_MPH, na.rm = TRUE))
ggplot(subset_m, aes(x = Speed_MPH)) +
geom_histogram(binwidth = 5, fill = "blue", color = "black", alpha = 0.7) +
facet_wrap(~ ServeNumber) +
geom_vline(data = mean_speeds, aes(xintercept = mean_speed),
color = "red", linetype = "dashed", size = 1) +
labs(title = "Distribution of Serve Speed (mph) by Serve Number (Males)",
x = "Serve Speed (mph)",
y = "Count") +
theme_minimal()
# save graph
ggsave("../images/serve_speed_males.png")
mean_speeds_f <- subset_f %>%
group_by(ServeNumber) %>%
summarise(mean_speed = mean(Speed_MPH, na.rm = TRUE))
ggplot(subset_f, aes(x = Speed_MPH)) +
geom_histogram(binwidth = 5, fill = "blue", color = "black", alpha = 0.7) +
facet_wrap(~ ServeNumber) +
geom_vline(data = mean_speeds_f, aes(xintercept = mean_speed),
color = "red", linetype = "dashed", size = 1) +
labs(title = "Distribution of Serve Speed (mph) by Serve Number (Females)",
x = "Serve Speed (mph)",
y = "Count") +
theme_minimal()
ggsave("../images/serve_speed_females.png")
## all serves (first and second)
ggplot(subset_m, aes(x = Speed_MPH, y = serving_player_won)) +
geom_density2d_filled(alpha = 0.8) +
labs(title = "Serve Speed vs. Win Outcome (Males, All Serves)") +
theme_minimal()
ggsave("../images/serve_speed_vs_win_males_all.png")
ggplot(subset_m, aes(x = Speed_MPH, y = serving_player_won)) +
geom_point() +
labs(title = "Serve Speed vs. Win Outcome") +
theme_minimal()
## split between 1st and 2nd serves
# first serves
first_serves <- subset_m %>%
filter(ServeNumber == 1)
ggplot(first_serves, aes(x = Speed_MPH, y = serving_player_won)) +
geom_point() +
labs(title = "Serve Speed vs. Win Outcome for First Serves") +
theme_minimal()
ggplot(first_serves, aes(x = Speed_MPH, y = serving_player_won)) +
geom_density2d_filled(alpha = 0.8) +
labs(title = "Serve Speed vs. Win Outcome for First Serves (Males, First Serves)") +
theme_minimal()
ggsave("../images/serve_speed_vs_win_males_first.png")
second_serves <- subset_m %>%
filter(ServeNumber == 2)
ggplot(second_serves, aes(x = Speed_MPH, y = serving_player_won)) +
geom_point() +
labs(title = "Serve Speed vs. Win Outcome for Second Serves (Males, Second Serves)") +
theme_minimal()
ggplot(second_serves, aes(x = Speed_MPH, y = serving_player_won)) +
geom_density2d_filled(alpha = 0.8) +
labs(title = "Serve Speed vs. Win Outcome for Second Serves (Males, Second Serves)") +
theme_minimal()
ggsave("../images/serve_speed_vs_win_males_second.png")
rm(list=ls())
# install.packages("fastDummies")
library(welo)
library(tidyverse)
library(data.table)
library(ggplot2)
setwd("C:/UPenn/tennis_wsabi/new code")
subset_m <- as.data.table(read.csv("../data/wimbledon_subset_m.csv"))
subset_f <- as.data.table(read.csv("../data/wimbledon_subset_f.csv"))
names(subset_m)
subset_m <- subset_m %>%
filter(ServeDepth != "", ServeWidth != "")
subset_f <- subset_f %>%
filter(ServeDepth != "", ServeWidth != "")
subset_m_second <- subset_m[ServeNumber == 2]
subset_f_second <- subset_f[ServeNumber == 2]
m_second_welos <- subset_m_second %>%
mutate(server_welo = if_else(PointServer == 1, player1_avg_welo, player2_avg_welo)) %>%
select(server_welo, speed_ratio)
cor(m_second_welos$server_welo, m_second_welos$speed_ratio, use = "complete.obs")
ggplot(m_second_welos, aes(x = server_welo, y = speed_ratio)) +
geom_point(alpha = 0.3) +
geom_smooth(method = "lm", se = FALSE, color = "red") +
labs(title = "Server wElo vs. Second Serve Speed Ratio (compared to avg first serve speed)",
x = "Server wElo",
y = "Second Serve Speed Ratio") +
theme_minimal()
f_second_welos <- subset_f_second %>%
mutate(server_welo = if_else(PointServer == 1, player1_avg_welo, player2_avg_welo)) %>%
select(server_welo, speed_ratio)
cor(f_second_welos$server_welo, f_second_welos$speed_ratio, use = "complete.obs") # -0.05 ish
ggplot(f_second_welos, aes(x = server_welo, y = speed_ratio)) +
geom_point(alpha = 0.3) +
geom_smooth(method = "lm", se = FALSE, color = "red") +
labs(title = "Server wElo vs. Second Serve Speed Ratio (compared to avg first serve speed)--Females",
x = "Server wElo",
y = "Second Serve Speed Ratio") +
theme_minimal()
ggplot(m_second_welos, aes(x = server_welo, y = speed_ratio)) +
geom_point(alpha = 0.3) +
geom_smooth(method = "lm", se = FALSE, color = "red") +
labs(title = "Server wElo vs. Second Serve Speed Ratio (compared to avg first serve speed)--Females",
x = "Server wElo",
y = "Second Serve Speed Ratio") +
theme_minimal()
ggplot(m_second_welos, aes(x = server_welo, y = speed_ratio)) +
geom_point(alpha = 0.3) +
geom_smooth(method = "lm", se = FALSE, color = "red") +
labs(title = "Server wElo vs. Second Serve Speed Ratio (compared to avg first serve speed)--Males",
x = "Server wElo",
y = "Second Serve Speed Ratio") +
theme_minimal()
cor(m_second_welos$server_welo, m_second_welos$speed_ratio, use = "complete.obs") # -0.05 ish
ggplot(m_second_welos, aes(x = server_welo, y = speed_ratio)) +
geom_point(alpha = 0.3) +
geom_smooth(method = "lm", se = FALSE, color = "red") +
labs(title = "Server wElo vs. Second Serve Speed Ratio--Males (corr ~ -0.05)",
x = "Server wElo",
y = "Second Serve Speed Ratio (compared to avg first serve speed)") +
theme_minimal()
ggsave("../images/male_welo_vs_second_serve_speed.png")
ggplot(f_second_welos, aes(x = server_welo, y = speed_ratio)) +
geom_point(alpha = 0.3) +
geom_smooth(method = "lm", se = FALSE, color = "red") +
labs(title = "Server wElo vs. Second Serve Speed Ratio --Females (corr ~ -0.14)",
x = "Server wElo",
y = "Second Serve Speed Ratio (compared to avg first serve speed)") +
theme_minimal()
ggsave("../images/female_welo_vs_second_serve_speed.png")
ggplot(f_second_welos, aes(x = server_welo, y = speed_ratio)) +
geom_point(alpha = 0.3) +
geom_smooth(method = "lm", se = FALSE, color = "red") +
labs(title = "Server wElo vs. Second Serve Speed Ratio --Females (corr ~ -0.14)",
x = "Server wElo",
y = "Second Serve Speed Ratio (compared to avg first serve speed)") +
theme_minimal()
ggsave("../images/female_welo_vs_second_serve_speed.png", bg = "white")
ggplot(f_second_welos, aes(x = server_welo, y = speed_ratio)) +
geom_point(alpha = 0.3) +
geom_smooth(method = "lm", se = FALSE, color = "red") +
labs(title = "Server wElo vs. Second Serve Speed Ratio --Females (corr ~ -0.14)",
x = "Server wElo",
y = "Second Serve Speed Ratio (compared to avg first serve speed)") +
theme_minimal()
ggsave("../images/female_welo_vs_second_serve_speed.png", bg = "white",
width = 8, height = 6, units = "in")
ggplot(f_second_welos, aes(x = server_welo, y = speed_ratio)) +
geom_point(alpha = 0.3) +
geom_smooth(method = "lm", se = FALSE, color = "red") +
labs(title = "Server wElo vs. Second Serve Speed Ratio -- Females (corr ~ -0.14)",
x = "Server wElo",
y = "Second Serve Speed Ratio (compared to avg first serve speed)") +
theme_minimal()
ggsave("../images/female_welo_vs_second_serve_speed.png", bg = "white",
width = 8, height = 6, units = "in")
ggplot(m_second_welos, aes(x = server_welo, y = speed_ratio)) +
geom_point(alpha = 0.3) +
geom_smooth(method = "lm", se = FALSE, color = "red") +
labs(title = "Server wElo vs. Second Serve Speed Ratio--Males (corr ~ -0.05)",
x = "Server wElo",
y = "Second Serve Speed Ratio (compared to avg first serve speed)") +
theme_minimal()
ggsave("../images/male_welo_vs_second_serve_speed.png", bg = "white",
width = 8, height = 6, units = "in")
ggplot(m_second_welos, aes(x = server_welo, y = speed_ratio)) +
geom_point(alpha = 0.3) +
geom_smooth(method = "lm", se = FALSE, color = "red") +
labs(title = "Server wElo vs. Second Serve Speed Ratio -- Males (corr ~ -0.05)",
x = "Server wElo",
y = "Second Serve Speed Ratio (compared to avg first serve speed)") +
theme_minimal()
ggsave("../images/male_welo_vs_second_serve_speed.png", bg = "white",
width = 8, height = 6, units = "in")
rm(list=ls())
# install.packages("fastDummies")
library(welo)
library(tidyverse)
library(data.table)
library(ggplot2)
library(reshape2)
subset_m <- as.data.table(read.csv("../data/wimbledon_subset_m.csv"))
subset_f <- as.data.table(read.csv("../data/wimbledon_subset_f.csv"))
names(subset_m)
subset_m <- subset_m %>%
filter(ServeDepth != "", ServeWidth != "")
subset_f <- subset_f %>%
filter(ServeDepth != "", ServeWidth != "")
subset_m_second <- subset_m[ServeNumber == 2]
subset_f_second <- subset_f[ServeNumber == 2]
## corr matrix male
numerical_x_cols <- c("p_server_beats_returner", "ElapsedSeconds", "importance", "speed_ratio")
subset_m_x <- subset_m_second %>% select(all_of(numerical_x_cols))
cor_matrix <- cor(subset_m_x, use = "complete.obs", method = "pearson")
cor_melt <- melt(cor_matrix)
ggplot(cor_melt, aes(x = Var1, y = Var2, fill = value)) +
geom_tile(color = "white") +
geom_text(aes(label = round(value, 2)), size = 3) +  # Add correlation values
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1, 1), name = "Correlation") +
labs(x = "", y = "", title = "Correlation Matrix with Coefficients") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# include categorical variables
subset_m_dummies <- subset_m_second %>%
mutate(across(c(ServeWidth, ServeDepth), as.factor)) %>%
fastDummies::dummy_cols(select_columns = c("ServeWidth", "ServeDepth"), remove_first_dummy = TRUE, remove_selected_columns = TRUE)
subset_m_all <- subset_m_dummies %>%
select(all_of(numerical_x_cols), starts_with("ServeWidth_"), starts_with("ServeDepth_"))
cor_matrix <- cor(subset_m_all, use = "complete.obs", method = "pearson")
cor_melt <- melt(cor_matrix)
ggplot(cor_melt, aes(x = Var1, y = Var2, fill = value)) +
geom_tile(color = "white") +
geom_text(aes(label = round(value, 2)), size = 3) +  # Add correlation values
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1, 1), name = "Correlation") +
labs(x = "", y = "", title = "Correlation Matrix with Coefficients") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave("../images/corr_matrix_male.png", bg = "white",
width = 8, height = 6, units = "in")
## corr matrix female
numerical_x_cols <- c("p_server_beats_returner", "ElapsedSeconds", "importance", "speed_ratio")
subset_f_x <- subset_f_second %>% select(all_of(numerical_x_cols))
cor_matrix <- cor(subset_f_x, use = "complete.obs", method = "pearson")
cor_melt <- melt(cor_matrix)
ggplot(cor_melt, aes(x = Var1, y = Var2, fill = value)) +
geom_tile(color = "white") +
geom_text(aes(label = round(value, 2)), size = 3) +  # Add correlation values
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1, 1), name = "Correlation") +
labs(x = "", y = "", title = "Correlation Matrix with Coefficients") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
# include categorical variables
subset_f_dummies <- subset_f_second %>%
mutate(across(c(ServeWidth, ServeDepth), as.factor)) %>%
fastDummies::dummy_cols(select_columns = c("ServeWidth", "ServeDepth"), remove_first_dummy = TRUE, remove_selected_columns = TRUE)
subset_f_all <- subset_f_dummies %>%
select(all_of(numerical_x_cols), starts_with("ServeWidth_"), starts_with("ServeDepth_"))
cor_matrix <- cor(subset_f_all, use = "complete.obs", method = "pearson")
cor_melt <- melt(cor_matrix)
ggplot(cor_melt, aes(x = Var1, y = Var2, fill = value)) +
geom_tile(color = "white") +
geom_text(aes(label = round(value, 2)), size = 3) +  # Add correlation values
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1, 1), name = "Correlation") +
labs(x = "", y = "", title = "Correlation Matrix with Coefficients") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave("../images/corr_matrix_female.png", bg = "white",
width = 8, height = 6, units = "in")
mean_speeds <- subset_m %>%
group_by(ServeNumber) %>%
summarise(mean_speed = mean(Speed_MPH, na.rm = TRUE))
ggplot(subset_m, aes(x = Speed_MPH)) +
geom_histogram(binwidth = 5, fill = "blue", color = "black", alpha = 0.7) +
facet_wrap(~ ServeNumber) +
geom_vline(data = mean_speeds, aes(xintercept = mean_speed),
color = "red", linetype = "dashed", size = 1) +
labs(title = "Distribution of Serve Speed (mph) by Serve Number (Males)",
x = "Serve Speed (mph)",
y = "Count") +
theme_minimal()
# save graph
ggsave("../images/serve_speed_males.png", bg = "white",
width = 8, height = 6, units = "in")
mean_speeds_f <- subset_f %>%
group_by(ServeNumber) %>%
summarise(mean_speed = mean(Speed_MPH, na.rm = TRUE))
ggplot(subset_f, aes(x = Speed_MPH)) +
geom_histogram(binwidth = 5, fill = "blue", color = "black", alpha = 0.7) +
facet_wrap(~ ServeNumber) +
geom_vline(data = mean_speeds_f, aes(xintercept = mean_speed),
color = "red", linetype = "dashed", size = 1) +
labs(title = "Distribution of Serve Speed (mph) by Serve Number (Females)",
x = "Serve Speed (mph)",
y = "Count") +
theme_minimal()
ggsave("../images/serve_speed_females.png", bg = "white",
width = 8, height = 6, units = "in")
## all serves (first and second)
ggplot(subset_m, aes(x = Speed_MPH, y = serving_player_won)) +
geom_density2d_filled(alpha = 0.8) +
labs(title = "Serve Speed vs. Win Outcome (Males, All Serves)") +
theme_minimal()
ggsave("../images/serve_speed_vs_win_males_all.png", bg = "white",
width = 8, height = 6, units = "in")
ggplot(subset_m, aes(x = Speed_MPH, y = serving_player_won)) +
geom_point() +
labs(title = "Serve Speed vs. Win Outcome") +
theme_minimal()
## split between 1st and 2nd serves
# first serves
first_serves <- subset_m %>%
filter(ServeNumber == 1)
ggplot(first_serves, aes(x = Speed_MPH, y = serving_player_won)) +
geom_point() +
labs(title = "Serve Speed vs. Win Outcome for First Serves") +
theme_minimal()
ggplot(first_serves, aes(x = Speed_MPH, y = serving_player_won)) +
geom_density2d_filled(alpha = 0.8) +
labs(title = "Serve Speed vs. Win Outcome for First Serves (Males, First Serves)") +
theme_minimal()
ggplot(first_serves, aes(x = Speed_MPH, y = serving_player_won)) +
geom_density2d_filled(alpha = 0.8) +
labs(title = "Serve Speed vs. Win Outcome for First Serves (Males, First Serves)") +
theme_minimal()
ggsave("../images/serve_speed_vs_win_males_first.png", bg = "white",
width = 8, height = 6, units = "in")
second_serves <- subset_m %>%
filter(ServeNumber == 2)
ggplot(second_serves, aes(x = Speed_MPH, y = serving_player_won)) +
geom_point() +
labs(title = "Serve Speed vs. Win Outcome for Second Serves (Males, Second Serves)") +
theme_minimal()
ggsave("../images/serve_speed_vs_win_males_second.png", bg = "white",
width = 8, height = 6, units = "in")
ggplot(second_serves, aes(x = Speed_MPH, y = serving_player_won)) +
geom_density2d_filled(alpha = 0.8) +
labs(title = "Serve Speed vs. Win Outcome for Second Serves (Males, Second Serves)") +
theme_minimal()
ggsave("../images/serve_speed_vs_win_males_second.png", bg = "white",
width = 8, height = 6, units = "in")
